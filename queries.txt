#fresh setup
ganache-cli -h 0.0.0.0 -l 20000000 -a 61 -m "cabin regret chest donate above loop type forget pond equip physical like"
cd graph-node/docker
sudo rm -R data/postgres
docker-compose up

cd ~/web3-tools
truffle migrate  	#copy tokenmanagementContract address to subgraph.yaml
./deployPerformanceTokens.sh

cd ~/cryptoraves-subgraph
yarn codegen
yarn build 
yarn create-local
yarn deploy-local

# TokenManagement Contract
curl -d '{"query": "{ deposits(first: 5){ id from value tokenAddress cryptoravesTokenId ercType } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ withdraws(first: 5){ id to value tokenAddress cryptoravesTokenId ercType } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph

#Transaction Management Contract
curl -d '{"query": "{ transfers(first: 5){ id from to amount tokenId tweetId } }"}' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ heresMyAddresses(first: 5){ id ethAddress cryptoravesAddress } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph

#User Management Contract
curl -d '{"query": "{ newUsers(first: 5){ id userId userName cryptoravesAddress imageUrl } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ usernameChanges(first: 5){ id userId userName blockNumber } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ imageChanges(first: 5){ id userId imageUrl blockNumber} }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph


#cryptoraves Token Contract
curl -d '{"query": "{ transferSingles(first: 5){ id operator from to cryptoravesTokenId value} }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ transferBatches(first: 5){ id operator from to cryptoravesTokenIds values} }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ approvalForAlls(first: 5){ id account operator approved } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ uris(first: 5){ id uri cryptoravesTokenId } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph




bundle exec twurl