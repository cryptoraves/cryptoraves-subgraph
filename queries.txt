#fresh setup
ganache-cli -h 0.0.0.0 -l 20000000 -a 61 -m "cabin regret chest donate above loop type forget pond equip physical like"


cd ~/web3-tools
truffle migrate  	#copy tokenmanagementContract address to subgraph.yaml
./deployPerformanceTokens.sh


cd ~/graph-node/docker
sudo rm -R data/postgres

docker-compose up


cd ~/cryptoraves-subgraph
yarn codegen
yarn build
yarn create-local

yarn deploy-local

#test send via skaleOracle pathway
python3 unittest_skaleOracle.py output '[[99434443434, 1376597010976026633, 0, 4949, 1, 1394711866161631238], ["Mr.Garrison", "@nomnominist", "TKA", "twitter", "transfer", "https://sample-imgs.s3.amazonaws.com/mr.garrison.png", ""]]'

# TokenManagement Contract
curl -d '{"query": "{ deposits(first: 5){ id to value tokenAddress cryptoravesTokenId ercType } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ withdraws(first: 5){ id from value tokenAddress cryptoravesTokenId ercType } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ tokens(first: 5){ id cryptoravesTokenId isManagedToken ercType totalSupply name symbol decimals emoji, tokenBrandImageUrl } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ cryptoDroppeds(first: 5){ id user cryptoravesTokenId } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph

#Transaction Management Contract
curl -d '{"query": "{ transfers(first: 5){ id from { id twitterUserId userName cryptoravesAddress imageUrl isManaged isUser dropped tokenId layer1Address } to { id twitterUserId userName cryptoravesAddress imageUrl isManaged isUser dropped tokenId layer1Address } amount token {id cryptoravesTokenId isManagedToken ercType totalSupply name symbol decimals emoji tokenBrandImageUrl } tweetId fromTo } }"}' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph

#User Management Contract
curl -d '{"query": "{ users(first: 5){ id twitterUserId userName cryptoravesAddress imageUrl isManaged isUser dropped tokenId layer1Address modified } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph

#cryptoraves Token Contract
curl -d '{"query": "{ transferSingles(first: 5){ id operator from to cryptoravesTokenId value} }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ transferBatches(first: 5){ id operator from to cryptoravesTokenIds values} }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ approvalForAlls(first: 5){ id account operator approved } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ uris(first: 5){ id uri cryptoravesTokenId } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph

#balances

curl -d '{"query": "{ userBalances(first: 500){ id, user { id twitterUserId userName cryptoravesAddress imageUrl isManaged isUser dropped tokenId layer1Address }, token {id cryptoravesTokenId isManagedToken ercType totalSupply name symbol decimals emoji tokenBrandImageUrl }, balance }}"}' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph



bundle exec twurl /1.1/statuses/home_timeline.json
