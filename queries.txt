#fresh setup
ganache-cli -h 0.0.0.0 -l 20000000
cd graph-node/docker
sudo rm -R data/postgres
docker-compose up

web3-tools/truffle migrate  	#copy tokenmanagementContract address to subgraph.yaml
web-tools/deployPerformanceToken.sh

yarn codegen
yarn build 
yarn create-local
yarn deploy-local

# TokenManagement Contract
curl -d '{"query": "{ transfers(first: 5){ id from to amount tokenId } }"}' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ deposits(first: 5){ id from value tokenAddress cryptoravesTokenId ercType } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph

#Transaction Management Contract
curl -d '{"query": "{ heresMyAddresses(first: 5){ id ethAddress cryptoravesAddress } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph

#User Management Contract
curl -d '{"query": "{ newUsers(first: 5){ id userId userName cryptoravesAddress imageUrl } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ usernameChanges(first: 5){ id userId userName } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ imageChanges(first: 5){ id userId imageUrl } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph


#cryptoraves Token Contract
curl -d '{"query": "{ transferSingles(first: 5){ id operator from to cryptoravesTokenId value} }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ transferBatches(first: 5){ id operator from to cryptoravesTokenIds values} }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ approvalForAlls(first: 5){ id account operator approved } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
curl -d '{"query": "{ uris(first: 5){ id uri cryptoravesTokenId } }" }' http://127.0.0.1:8000/subgraphs/name/cryptoraves/cryptoraves-subgraph
